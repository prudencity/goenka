SELECT cr, case when dr ='0' then 'Cash' else dr end as dr, amount, CONVERT(VARCHAR(10), dt, 112) dt  FROM(Select fp.F_Id as id, p.P_Name as cr, (fp.F_Principal + fp.F_InterestAmount + fp.F_Previous) as amount, fp.F_Date as dt from AccountForeClosure as fp, LoanSanction as ls, PartyMaster as p WHERE fp.F_SId = ls.L_Id AND ls.L_PartyId = P.P_Id) as t_cr,(SELECT fp.F_Id as id, ISNULL(party.P_Name,'0') AS dr FROM AccountForeClosure fp LEFT OUTER JOIN PartyMaster party  on fp.F_BankId = party.P_Id) as t_dr WHERE t_cr.id = t_dr.id AND dt in ('20150515');